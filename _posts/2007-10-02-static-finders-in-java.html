---
layout: post
title: "Static Finders in Java"
date: 2007-10-02
comments: false
categories:
 - java
 - database
---

<div class='post'>
<p>For the past couple days, I've been unnaturally obsessed with the Ruby syntax for looking up persistent objects.  The <a href="http://railsmanual.org/class/ActiveRecord::Base/find/1.1.2">ActiveRecord find API</a> is <i>absolutely</i> a piece of art.</p><br /><br /><pre><br /># returns the object for ID = 1<br />Book.find(1);<br /></pre><br /><br /><p>While Java API's force developers to think about Services and DAO's, Ruby/ActiveRecord focuses on the Domain Model which is all that <i>really</i> matters.  I've <a href="http://jroller.com/wireframe/entry/humane_object_iteration">said this in the past</a>, it's all about <i><b>context</b></i>.   We need to be creating <b>expressive</b> and <b>simple</b> API's that enable developers to build applications without being constrained by the underlying architecture.</p><br /><br /><p>What if we could have the best of both worlds?  Why don't we see this kind of Ruby syntax in Java applications?  Is it because of the assumption that <a href="http://beust.com/weblog/archives/000173.html"><i>static methods are evil</i></a>?  Java developers have a lot to learn from Ruby, and here's how to build a Ruby-like finder method in Java.</p><br /><br /><p>I'll start with my client code.  It needs to be <i>simple</i> and not worried about Services or Daos to lookup my persistent objects.</p><br /><br /><pre><br />public class BookLister {<br />   public void printBooks() {<br />       foreach (Book book : Book.findAll()) {<br />           System.out.println(book.getName());<br />       }<br />   }<br />}<br /></pre><br /><br /><p>Next, we need expose this finder method on our business object.  Don't worry, I'm not advocating that we perform some magic hack to manually create database connections within these methods.  We'll use standard dependency injection techniques and encapsulate the database access within a standard DAO object and delegate the call from the business object to the DAO.</p><br /><br /><pre><br />public class Book {<br />   private static BookDao dao;<br />   private String name;<br />  <br />   public static Collection findAll() {<br />       return dao.findAll();<br />   }<br /><br />   public static void setBookDao(BookDao dao) {<br />       this.dao = dao;<br />   }<br />}<br /></pre><br /><br /><p>Our final step is to configure the business object to have access to the DAO.  This is super simple for a Spring application, and I'd be very interested to see if something like Guice could be used instead of this XML configuration.  Or maybe build some custom Annotations?</p><br /><br /><pre><br />&lt;beans&gt;<br />   &lt;bean id="bookDao" class="com.mysite.BookDao" /&gt;<br /><br />   &lt;bean id="bookInit" class="com.mysite.Book"&gt;<br />       &lt;property name="bookDao"&gt;&lt;ref bean="bookDao" /&gt;&lt;/property&gt;<br />   &lt;/bean&gt;<br />&lt;/beans&gt;<br /></pre><br /></div>
