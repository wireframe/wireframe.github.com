---
layout: post
title: "Choice Is Good"
date: 2005-09-06
comments: false
categories:
 - java
 - scriptaculous
 - wicket
 - ajax
---

<div class='post'>
<p>I've spent the last couple weeks straining my brain to create <a href="http://jroller.com/page/wireframe/?anchor=wicket_autocomplete_text_field">a slick autocomplete text field for Wicket</a>.  Over this time, I've come up with several different use cases for such a component.  Now, instead of trying to create one <i>uber</i> component that can do it all, I have decided that it makes more sense to have different components for different use cases.  This should make it much easier for users since each component has a very explicit and simple API.</p><br /><br /><h3>AutocompleteTextField</h3><br /><p>This is the basic autocomplete implementation that is 100% AJAX free.  Simply instantiate the text field with all the possible options, and scriptaculous' built in filtering features will take care of the rest.  This is an easy solution for small datasets.</p><br /><pre><br />String[] results = new String[] {<br />    "Red"<br />    , "Blue"<br />    , "Purple"<br />    , "Orange"<br />};<br />add(new AutocompleteTextField("color", results));<br /></pre><br /><br /><h3>AjaxAutocompleteTextField</h3><br /><p>And now for some AJAX magic.  The AjaxAutocompleteTextField provides a simple callback to allow for dynamically populating the list of available auto completions based on the user input.</p><br /><pre><br />add(new AjaxAutocompleteTextField("fruit") {<br />    public String[] getResults(String input) {<br />        //lookup potential results from database or something<br />        return new String[] {<br />            "Apple"<br />            , "Banana"<br />        };<br />    }<br />});<br /></pre><br /><br /><h3>CustomLayoutAjaxAutocompleteTextField</h3><br /><p>My <a href="http://jroller.com/page/wireframe/?anchor=autocomplete_more_than_just_text">previous blog entry</a> introduced how to autocomplete more than just text.  I wanted to improve the API so that the html markup would be done outside the Java code.</p><br /><br /><p>After several iterations, I created something called a <i>PageContribution</i>.  The concept behind a PageContribution is that it supplies only a portion of the html for a page.  This allows for users to completely customize the layout of autcomplete results.  The CustomLayoutAjaxAutocompleteTextField delegates the rendering of the autocomplete results to the PageContribution.  Under the covers, it works exactly as a normal Wicket page, but it's intention is to only provide markup for the autocomplete results.</p><br /><br /><p>There are a number of benifits to this approach.  Not only can you completely customize the layout of the autocomplete results, you can also directly invoke the autocomplete results as a seperate page to preview the results.  This is one feature of the scriptaculous examples that really impressed me.  Simply view the source of the demo and you can extract the url for the autocomplete component.</p><br /><br /><pre><br />add(new CustomLayoutAjaxAutocompleteTextField("emailAddress", <br />    ExampleAjaxAutocompletePageContribution.class));<br /></pre><br /><br /><p>A helper abstract class (CustomLayoutAutocompleteResultsPageContribution) is available to handle extracting the user's input from the correct input parameter.</p><br /><pre><br />public class ExampleAjaxAutocompletePageContribution <br />    extends CustomLayoutAutocompleteResultsPageContribution {<br /><br />    public ExampleAjaxAutocompletePageContribution(PageParameters parameters) {<br />        super(parameters);<br />    }<br /><br />    protected ListView buildListView(String input) {<br />        //lookup results from string input<br />        List results = new ArrayList();<br />        results.add(new CustomResultObject("ryan.gif", "Ryan Sonnek", "ryan@youremail.com"));<br />        results.add(new CustomResultObject("billy.gif", "Bill Gates", "bill.gates@microsoft.com"));<br /><br />        return new ListView("entries", results) {<br />            protected void populateItem(ListItem item) {<br />                CustomResultObject result = (CustomResultObject) item.getModelObject();<br /><br />                item.add(new Label("name", result.getName()));<br />                item.add(new Label("email", result.getEmail()));<br />            }<br />        };<br />    }<br /></pre><br /><br /><p>The PageContribution then supplies it's own html markup for how to render the autocomplete results,</p><br /><pre><br />&lt;ul wicket:id="entries"&gt;<br />  &lt;li&gt;<br />    &lt;div wicket:id="name">Ryan Sonnek&lt;/div&gt;<br />    &lt;div wicket:id="email">ryan@somewhere.com&lt;/div&gt;<br />  &lt;/li&gt;<br />&lt;/ul&gt;<br /></pre><br /><br /><p>I have added examples for each of these use cases to <a href="http://wicket-stuff.sf.net">wicket-stuff</a> along with a Jetty launcher for anyone that wants to give them a test drive.</p></div>
