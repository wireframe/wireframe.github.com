---
layout: post
title: "Wicket Client Side Validation"
date: 2008-01-27
comments: false
categories:
 - java
 - wicket
 - ajax
 - validation
---

<div class='post'>
<p>Over the past several weeks, I've been been seeing lots of posts for <a href="http://extjs.com/deploy/ext/examples/form/dynamic.html">fancy</a> <a href="http://www.jsvalidate.com/">Javascript</a> <a href="http://tetlaw.id.au/view/javascript/really-easy-field-validation">validation</a> libraries.  I spent a couple weeks playing around with integrating these libraries into Wicket, but something didn't feel quite right.  Giving users instant feedback when filling in data forms is *really* nice, but what is the best way to support it?</p><br /><br /><p>Before we can really dive into the issue of client side validation, we must first be perfectly clear that server side validation is absolutely critical.  There is no question that we *need* validation done on the server side to prevent a user bypassing validation just by turning off javascript.  </p><br /><br /><p>If server side validation is mandatory, how do you add client side validation with the least amount of work?  I mean, how do you get the "most bang for your buck" and not have to re-do all of the server side validation rules with custom code on the client side?  The trouble is, server side validation runs in Java, and client side validation runs in Javascript.  How can these two languages perform the *exact* same validation rules without a LOT of extra work?  How do you get *cohesive*, *localized* messaging for both server side and client side validation errors?  I have yet to see a Javascript validation library that handles localized messages as robustly as Java validation frameworks.</p><br /><br /><p>My answer?  Use Ajax.</p>  <br /><br /><p>Instead of re-implementing all of the server side validation rules in Javascript, just use Ajax to call into the server to perform the REAL validation and give the user feedback.  The user gets instant feedback, and we don't have to "jump through hoops" and write separate Javascript validation libraries to do what is already supported on the server side.</p><br /><br /><p>Wicket handles this beautifully with the <code>AjaxFormValidatingBehavior</code>.</p><br /><pre><br />public class MyForm extends WebPage &#123;<br />  public MyForm() &#123;<br />    add(new FeedbackPanel("feedback").setOutputMarkupId(true));<br /><br />    Form form = new Form("form", new CompoundPropertyModel(new MyObject()))&#123;<br />      public void onSubmit() &#123;<br />        //do something <br />      &#125;<br />    &#125;);<br />    add(form);  <br /><br />    TextField name = new TextField("name");<br />    name.setRequired(true);<br />    form.add(name);<br /><br />    AjaxFormValidatingBehavior.addToAllFormComponents(form, "onblur");<br />  &#125;<br />&#125;<br /></pre><br /><br /><p>Boom!  Just like that, you have client side validation in Wicket.  In this example, the user will get an error message if they try to leave the name field blank.  Seriously, can it get any easier than this?  Actually it can, if you use hibernate annotations, your Wicket component can <a href="http://jroller.com/wireframe/entry/wicketstuff_hibernate_updates">automatically configured instead of having to manually set requiredness or add validators</a>.  You could also automatically attach this Ajax behavior to all of your forms by using a <code>ComponentInstantiationListener</code>.</p><br /><br /><p>Some people may complain that this is no longer "client side" validation since we're making a call to the server.  So WHAT!?!  I will gladly pay the cost to have this done on the server where I'm *guaranteed* to have the correct validation rules fire.  There is a definite risk of a possible mismatch between the client side and server side validation rules since they are written in two completely different languages.  It's all too plausible for a javascript validator to have different syntax rules than the server side rules which could ultimately lead to preventing users from entering data that passes the server side validation rules.  This may not be a worry for simple "is required" validation, but email address and phone number validation is much more complex and changes between implementations.</p><br /><br /><p><a href="http://raibledesigns.com/rd/entry/comparing_jvm_web_frameworks_presentation">Matt Raible gave Wicket low marks in this area</a> because no fancy javascript validation libraries are built into Wicket like in <a href="http://tapestry.apache.org/tapestry4.1/usersguide/clientside-validation.html">Tapestry</a>, but I don't understand why?  In my mind, as long as you're giving the user instant feedback, there's no real difference between:</p><br /><ol><br /><li>executing Javascript validators</li><br /><li>using Javascript to call serverside validation</li><br /></ol><br /><br /><p>Thoughts?</p></div>
<h2>Comments</h2>
<div class='comments'>
<div class='comment'>
<div class='author'>Andrzej Bednarz</div>
<div class='content'>
Hi,<br />I like you post, it shows very interesting ideas. However, please find the following reasons why I think there is a difference between JavaScript validation and using JavaScript to call server-side validation.<br /><br />1. JavaScript validation scales better. Imagine you have 100 clients filling a simple form at the same time. With Wicket you have 100 requests more on the server. What if you have 10000 clients? <br /><br />2. Wicket can generate large responses for even a simple validation request when a component refresh is involved (which is often the case). Wicket sends complete HTML of a component which state has changed. In our application we have simple input but this input has many JavaScript and hidden icons/text attached. With Wicket server-side validation server sends full HTML for this input every time we perform even the simplest validation. This might be overkilling to the network. <br /><br />3. There are cases when JavaScript validation works faster (there is no network communication overhead) and thanks to that UI can be more responsive (better usability).<br /><br />Moreover, these days there are some frameworks which enables you to write validation code in one place and use it for both JavaScript validation and server-side validation, see GWT for instance. <br /><br />So I think Wicket approach is very interesting and useful for many types of applications but it has some limitations. Wicket&#39;s approach to validation might be even unusable for some projects, especially when scalability and network bandwidth utilizations are the main constraints.</div>
</div>
</div>
